<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_treatment_schedule">
        <t t-call="web.html_container">

            <t t-set="company" t-value="env.company"/>

            <t t-call="web.external_layout_standard">
                <t t-foreach="docs" t-as="doc">
                    <div class="page">

                        <!-- ===== Header ===== -->
                        <div style="text-align:center; margin-bottom:8px;">

                            <!-- Logo -->
                            <t t-if="company.logo">
                                <img t-att-src="'data:image/png;base64,%s' % company.logo"
                                     style="max-height:95px; display:block; margin:0 auto;"/>
                            </t>

                            <!-- space under logo -->
                            <div style="height:14px;"></div>

                            <!-- Yellow line -->
                            <div style="height:7px; background:#f2b233; width:100%;"></div>

                            <!-- Title + Date (same row) -->
                            <div style="
                                display:grid;
                                grid-template-columns: 1fr auto 1fr;
                                align-items:center;
                                margin-top:12px;
                            ">
                                <div></div>

                                <div style="
                                    font-size:22px;
                                    font-weight:700;
                                    color:#666;
                                    text-align:center;
                                ">
                                    Treatment Schedule
                                </div>

                                <div style="
                                    text-align:right;
                                    font-size:14px;
                                    color:#666;
                                    font-weight:700;
                                ">
                                    Date:
                                    <t t-if="doc.date">
                                        <span style="display:inline-block; padding-left:8px;">
                                            <span t-field="doc.date"/>
                                        </span>
                                    </t>
                                    <t t-else="">
                                        <span style="display:inline-block; width:14px;"></span> /
                                        <span style="display:inline-block; width:14px;"></span> /
                                        <span style="display:inline-block; width:14px;"></span>
                                    </t>
                                </div>
                            </div>
                        </div>

                        <!-- ===== Table ===== -->
                        <table style="width:100%; border-collapse:collapse; font-size:12px; margin-top:12px;">
                            <thead>
                                <tr>
                                    <th style="border:1px solid #777; padding:6px; text-align:left; background:#cfe3f1;">
                                        Session Type
                                    </th>
                                    <th style="border:1px solid #777; padding:6px; text-align:center;">WK 1</th>
                                    <th style="border:1px solid #777; padding:6px; text-align:center;">WK 2</th>
                                    <th style="border:1px solid #777; padding:6px; text-align:center;">WK 3</th>
                                    <th style="border:1px solid #777; padding:6px; text-align:center;">WK 4</th>
                                    <th style="border:1px solid #777; padding:6px; text-align:center;">WK 5</th>
                                    <th style="border:1px solid #777; padding:6px; text-align:center;">WK 6</th>
                                    <th style="border:1px solid #777; padding:6px; text-align:center;">WK 7</th>
                                    <th style="border:1px solid #777; padding:6px; text-align:center;">WK 8</th>
                                </tr>
                            </thead>

                            <tbody>
                                <t t-foreach="doc.line_ids" t-as="l">
                                    <tr>
                                        <td style="border:1px solid #777; padding:8px; color:#666;">
                                            <t t-esc="l.product_id.display_name"/>
                                        </td>

                                        <!-- WK1 -->
                                        <td style="border:1px solid #777; height:32px; text-align:center; vertical-align:middle;">
                                            <div style="font-size:10px; color:#666;">
                                                <t t-esc="l.wk1_date or ''"/>
                                            </div>
                                            <div style="font-weight:700; font-size:12px;">
                                                <t t-esc="l.wk1_number or ''"/>
                                            </div>
                                        </td>

                                        <!-- WK2 -->
                                        <td style="border:1px solid #777; height:32px; text-align:center; vertical-align:middle;">
                                            <div style="font-size:10px; color:#666;">
                                                <t t-esc="l.wk2_date or ''"/>
                                            </div>
                                            <div style="font-weight:700; font-size:12px;">
                                                <t t-esc="l.wk2_number or ''"/>
                                            </div>
                                        </td>

                                        <!-- WK3 -->
                                        <td style="border:1px solid #777; height:32px; text-align:center; vertical-align:middle;">
                                            <div style="font-size:10px; color:#666;">
                                                <t t-esc="l.wk3_date or ''"/>
                                            </div>
                                            <div style="font-weight:700; font-size:12px;">
                                                <t t-esc="l.wk3_number or ''"/>
                                            </div>
                                        </td>

                                        <!-- WK4 -->
                                        <td style="border:1px solid #777; height:32px; text-align:center; vertical-align:middle;">
                                            <div style="font-size:10px; color:#666;">
                                                <t t-esc="l.wk4_date or ''"/>
                                            </div>
                                            <div style="font-weight:700; font-size:12px;">
                                                <t t-esc="l.wk4_number or ''"/>
                                            </div>
                                        </td>

                                        <!-- WK5 -->
                                        <td style="border:1px solid #777; height:32px; text-align:center; vertical-align:middle;">
                                            <div style="font-size:10px; color:#666;">
                                                <t t-esc="l.wk5_date or ''"/>
                                            </div>
                                            <div style="font-weight:700; font-size:12px;">
                                                <t t-esc="l.wk5_number or ''"/>
                                            </div>
                                        </td>

                                        <!-- WK6 -->
                                        <td style="border:1px solid #777; height:32px; text-align:center; vertical-align:middle;">
                                            <div style="font-size:10px; color:#666;">
                                                <t t-esc="l.wk6_date or ''"/>
                                            </div>
                                            <div style="font-weight:700; font-size:12px;">
                                                <t t-esc="l.wk6_number or ''"/>
                                            </div>
                                        </td>

                                        <!-- WK7 -->
                                        <td style="border:1px solid #777; height:32px; text-align:center; vertical-align:middle;">
                                            <div style="font-size:10px; color:#666;">
                                                <t t-esc="l.wk7_date or ''"/>
                                            </div>
                                            <div style="font-weight:700; font-size:12px;">
                                                <t t-esc="l.wk7_number or ''"/>
                                            </div>
                                        </td>

                                        <!-- WK8 -->
                                        <td style="border:1px solid #777; height:32px; text-align:center; vertical-align:middle;">
                                            <div style="font-size:10px; color:#666;">
                                                <t t-esc="l.wk8_date or ''"/>
                                            </div>
                                            <div style="font-weight:700; font-size:12px;">
                                                <t t-esc="l.wk8_number or ''"/>
                                            </div>
                                        </td>
                                    </tr>
                                </t>

                                <!-- Blank rows -->
                                <t t-set="extra_rows" t-value="max(0, 12 - len(doc.line_ids))"/>
                                <t t-foreach="range(extra_rows)" t-as="i">
                                    <tr>
                                        <td style="border:1px solid #777; height:32px;"></td>
                                        <td style="border:1px solid #777; height:32px;"></td>
                                        <td style="border:1px solid #777; height:32px;"></td>
                                        <td style="border:1px solid #777; height:32px;"></td>
                                        <td style="border:1px solid #777; height:32px;"></td>
                                        <td style="border:1px solid #777; height:32px;"></td>
                                        <td style="border:1px solid #777; height:32px;"></td>
                                        <td style="border:1px solid #777; height:32px;"></td>
                                        <td style="border:1px solid #777; height:32px;"></td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>

                        <!-- ===== Special Instructions ===== -->
                        <div style="margin-top:18px; border:1px solid #777; padding:14px;">
                            <div style="font-weight:700; color:#777; margin-bottom:8px; font-size:14px;">
                                Special Instructions:
                            </div>

                            <t t-foreach="range(6)" t-as="x">
                                <div style="border-bottom:1px dashed #999; height:18px;"></div>
                            </t>
                        </div>

                    </div>
                </t>
            </t>
        </t>
    </template>
</odoo>
